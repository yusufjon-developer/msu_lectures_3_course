# Лекция 1

## Структура системного и прикладного программного обеспечения

Программное обеспечение (ПО) это совокупность программ, процедур, правил и сопутствующий документации обеспечивающий
функционировании вычислительной системы и решение прикладных задач пользователя. В современной информатике ПО
рассматривается как неотъемлемая часть вычислительной системы на ряду с аппаратным обеспечением в зависимости от
назначения и уровня взаимодействия с аппаратными средствами ПО принято делить на системные и прикладное. Иногда также
выделяют промежуточный уровень как инструментальные ПО который обычно является частью системного ПО. Основное различие
между системным и прикладным ПО заключается в следующим:

- Системное ПО обеспечивает в функционировании компьютера и создает среду для выполнения других программ;
- Программное ПО ориентированно на решение конкретных задач пользователя в различных предметных областях.

Понимание структур и взаимодействие этих уровней лежит в основе разработки анализа и оптимизации программных систем.
Системное ПО представляет собой многоуровневую структуру обеспечивающую управления аппаратными ресурсами и выполнение
прикладных программ в основном существуют три вида системных ПО:

1. Базовое системное ПО;
2. Операционная система (ОС);
3. Служебное и инструментальное ПО.

### Базовое системное ПО

К нему относятся программы непосредственно взаимодействующие с аппаратурой компьютера. Примерами являются
микропрограммы (firmware). Это программы записанные в постоянной памяти. Например, BIOS или UEFI которые выполняют
начальную инициализацию оборудования и инициализацию ОС. Другой это загрузчики ОС они обеспечивают запуск ОС при
включении компьютера.

### Операционная система

Это ключевой компонент системного ПО. Она выполняет функцию посредника между аппаратными ресурсами и пользователям, а
также между аппаратурой и прикладными ПО. Основные функции ОС это управление процессами (создание, планирование,
завершение), управление памятью, управление файловыми системами, управление устройствами ввода/вывода, обеспечение
защити и ограничении доступа, предоставлении пользовательского интерфейса. С точки зрения структуры ОС включает
(состоит):

- ядро ОС реализующие основные функции управления ресурсами;
- драйверы устройств обеспечивающий взаимодействие с конкретным оборудованиям;
- системные библиотеки предоставляющие стандартные функции для программ;
- оболочки и интерфейсы пользователя.

### Служебные и инструментальные ПО

Служебные и инструментальные ПО, являются частью системного ПО. Служебные ПО (утилиты) это средство диагностики,
архивирования, резервного копирования, антивирусной защиты и т.д. Инструментальное ПО это различные компиляторы,
интерпретаторы, отладчики и различные среды разработки (IDE). Инструментальное ПО в основном обеспечивают процесс
создания и анализа программных средств.

Т.к. прикладные программные обеспечения предназначены для решения задач пользователя их можно классифицировать по
назначению следующим образом:

- Прикладные ПО общего назначения. К ним относятся программы использующие широким кругом пользователей, такие как
  текстовые процессоры, электронные таблицы, системы управления базами данных и графические редакторы;
- специализированные прикладные ПО, которые ориентированы на конкретные области, таких как математические пакеты
  (Matlab, Wolfram Alpha), системы компьютерной алгебры, статистический и аналитические системы, инженерные и научные
  пакеты.
- Профессиональные и корпоративные ПО которые используются в промышленности, науке и бизнесе. Например, системы
  автоматизированного проектирования CAD, системы управления предприятием EAP, аналитические платформы и системы
  моделирования. С точки зрения архитектуры прикладное ПО, может включать ы себе пользовательский интерфейс, прикладную
  логику, слой доступа к данным, средства взаимодействия с ОС и внешними библиотеками. Во многих современных системах
  используется многоуровневая архитектура, что позволяет повысить масштабируемость и надежность программ. Системные и
  прикладное ПО функционируют во взаимосвязи. Прикладные программы не имеют прямого доступа к аппаратным ресурсам и
  обращаются к ним через интерфейсы предоставляемые ОС к основным механизмам взаимодействия между системным и прикладным
  ПО относятся системные вызовы, программные интерфейсы (API) и стандартные библиотеки. Такой подход взаимосвязи
  обеспечивает безопасность системы, независимость прикладных программ от конкретного оборудования и переносимость ПО.
  Во Время реализации прикладных ПО важную роль играют составление правильных математических моделей и алгоритмов, т.к.
  они обеспечивают корректную работу программы в различных вычислительных средах и ОС. Структура ПО вычислительной
  системы представляет собой иерархию уровней от базового системного ПО до прикладных программ ориентированных на
  конечного пользователя. Знания структуры и принципов взаимодействия системного и прикладного ПО, является необходимой
  и основой позволяющей эффективно разрабатывать, анализировать и оптимизировать программные системы различного
  назначения.

## Динамические библиотеки DLL. Статическое и динамическое связывание

Программная библиотека эта набор готовых функций процедур классов или модулей предназначенных для повторного
использования в различных программах. Наиболее популярным и широко используемым примером программных библиотек является
DLL - Dynamic Link Library. Библиотеки больше всего предназначены для повторного использования кода, сокращении времени
разработки, упрощение сопровождение программ, уменьшения количество ошибок и стандартизация программных решений.
Библиотеки широко применяются при разработке системного и прикладного ПО и являются важной частью современных
программных систем. В зависимости от способа подключения к программе существуют два вида библиотек:

1. Статические библиотеки;
2. Динамические библиотеки.

Каждое из этих видов предполагает свой механизм связывания и имеет определенные преимущество и недостатки.

### Статическое связывание

Это процесс при котором код библиотеки подключается в исполняемый файл программы на этапе
компиляции или компоновки при этом все необходимые функции библиотеки становятся частью исполняемого файла и программа
не зависит от наличия библиотеки во время выполнения. У статической связи имеется следующие особенности. Библиотека
подключается один раз при сборке программы. Создается единый исполняемый файл. Преимущество независимость от внешних
библиотек, простота развертывания программы, стабильность работы. Недостатки увелечения размера исполняемого файла.
Дублирование кода библиотек в разных программах, необходимость перекомпиляции при обновлении библиотеки.

### Динамическое связанные

Это процесс подключения библиотек во время выполнения программы. При этом код библиотеки не
включается в исполняемый файл полностью и загружается в память при запуске программы или по требованию.

Примером статических библиотек могут быть файлы формата *.lib, *.a. А динамические это файлы формата *.dll

DLL является динамической библиотекой в которой используется в ОС семейство Windows. В первые эти библиотеки были
созданы корпорацией Microsoft с целью сокращение кодов, стабильной работай ОС, экономией памяти и исключение повторов.
Основными особенностями DLL являются:

1. Содержит набор функций, процедур и ресурсов;
2. Может использоваться несколькими программами одновременно;
3. Загружаются в память по мере необходимости.

Преимуществами DLL являются:

- Уменьшение размера исполняемых файлов;
- Экономия ОЗУ;
- Упрощение обновление программ;
- Совместное использование кода.

К недостаткам относятся:

- Зависимость программы от версии библиотеки;
- Возможные конфликты версий;
- Усложнение процесса отладки.

Существуют два способа динамического связывание;

1. Неявное динамическое связывание. В нём библиотека указывается при компиляции загрузка DLL происходить при запуске
   программы функции доступны напрямую;
2. Явное динамическое связывание. При нем библиотека загружается по адресу во время выполнения, функции получается по
   указателям и они позволяют гибко управлять подключаемыми модулями.

Динамические библиотеки широко применяются в ОС, в графических и офисных приложениях, в математических и инженерных
пакетах, в модульных и плагин ориентированных системах. Для решения задач прикладной математики и информатики DLL
библиотеки позволяют выносить вычислительные модули в отдельные компоненты, повторно использовать математические
алгоритмы и создавать расширяемые программные системы. Для создания DLL библиотек существуют разные способы:

1. С использованием определенных команд командной строки с указанием отдельных различных значений параметров и при этом
   основной код библиотеки может храниться в обычных текстовых файлах;
2. С использованием специальных возможностей определенных языков программирования. Например, для среды RAD Studio
   Embarcadero с использованием утилиты DLL Wizard;
3. Использование специальных программных обеспечений.

Для создания библиотеки DLL применяемый в программах языка Delphi необходима после части реализации результата указать
код нужной функции и в части exports объявлять имена всех функций которые могут быть использованы в программах.

# Лекция 2

## Библиотеки API Windows

Windows API это совокупность функций, типов данных, структур и констант предоставляемых ОС Windows для создания
прикладных команд. Windows API обеспечивает:

- Доступ к ресурсам ОС;
- Взаимодействие с аппаратным обеспечением;
- Создание пользовательского интерфейса;
- Управление процессами, памятью и файлами.

Для разработчиков Windows API является промежуточным слоем между разрабатываемым прикладным ПО и ядром ОС. Windows API
имеет следующие основные задачи:

1. обеспечение стандартного способа работы с ОС;
2. Аппаратная независимость приложений;
3. Унификация разработки ПО под Windows;
4. Поддержка многозадачности и многопоточность.

Характерными особенностями Windows API являются процедурно ориентированный интерфейс, использование системных типов
данных, поддержка событийной модели и тесная интеграция с DLL библиотеками. Windows API имеет иерархическую структуру и
реализуется в виде набора динамических библиотек. Под основными уровнями относятся уровень пользовательских приложений,
уровень Windows API и уровень ядра ОС которую обычно называют Kernel Mode. Разработанные приложения взаимодействуют с
ядром ОС исключительно через API в результате чего обеспечивается безопасность и стабильность системы. Windows API
состоит или содержит определенное количество DLL библиотек самыми основными из них являются следующие библиотеки:

- Kernel32.dll это базовая библиотека Windows API которая обеспечивает низкоуровневые функции основными группами функций
  являются управление процессами и потоками, управление памятью, работа с файлами и каталогами, обработка ошибок и
  синхронизация потоков. Примерами таких функций являются CreateProcess, CreateFile, ReadFile, WriteFile, GetLastError.
- User32.dll отвечает за взаимодействие с пользователем и оконную подсистему. К основным функциям данной библиотеки
  относятся создание и управление окнами, обработка сообщений, работа с клавиатурой и мышью, управление диалоговыми
  окнами. Примерами функций данной библиотеки являются CreateWindow, ShowWindow, MessageBox, DispatchMessage.
- Gdi32.dll реализует графический интерфейс низкого уровня. К его основным возможностям относятся вывод графики и
  текста, работа с устройствами вывода и управление шрифтами и цветами. Примерами функций библиотеки являются TextOut,
  LineTo, Rectangle, CreateFont.
- Advapi32.dll он предоставляет расширенные функции ОС. К основным возможностям данной библиотеки относятся управление
  службами windows, работа с реестром, безопасность и учтенные записи и контроль доступа. К основным функциям относятся
  RegOpenKeyEx, RegSetValueEx, OpenProcessToken.

Для использования функций Windows API необходимо подключать соответсвующий заголовочные файлы. На C++ объявляют <
windows.h>, а Delphi uses Winapi.Windows, Winapi.Messages. Аналогично в некоторых языках программирования к коду
программы автоматически добавляются соответствующие модули обеспечивающие работу с функциями библиотеки Windows API. В
некоторых других языков программах данная операция тоже выполняется автоматически, но он будет скрытым от посторонних
глаз. Кроме языков C/C++, Delphi и C++ Builder Windows API также используется в языках высокого уровня через обертки.
Windows API позволяет следующее:

1. Разрабатывать прикладные и системные ПО;
2. Эффективно управлять вычислительными ресурсами;
3. Создавать высокопроизводительные приложения;
4. Интегрировать математические алгоритмы с ОС.

Для разработчиков знание Windows API является важной и применяется при создании вычислительных приложений, научных и
инженерных программ, а также высоко нагруженных систем. Обычно программы под Windows работают на основе обработки
сообщений к числу которых относятся события от пользователя, системные сообщения, сообщения таймеров и окон. К основным
элементом относятся очередь сообщений, цикл обработки сообщений и оконная процедура. Заголовочные файлы которые
используются во время разработки ПО особенно библиотеки <windows.h>, Winapi.Windows, Winapi.Messages включают в себя
большинство стандартных объявлений на подобии типы данных Handle, DWORD, byte, integer и т.д. Пример структур WNDCLASS,
MSG. Прототипы функций и системные константы. Обычно при использовании Windows API используются следующие типы данных
которые являются собственными для Windows API.

| Тип        | Назначение               |
|:-----------|:-------------------------|
| **HANDLE** | Универсальный дескриптор |
| **HWND**   | Дескриптор окна          |
| **HDC**    | Контекст устройства      |
| **DWORD**  | 32-битное целое число    |
| **LPVOID** | Указатель на данные      |

Использования этих типов повышает переносимость и совместимость.

# Лекция 3

# ini файлы

Во время разработки различных программ часто приходится запоминать различные основные параметры такие как параметры
пользователя, конфигурация интерфейса, пути к файлам, сетевые настройки, параметры алгоритма, состояние программы и т.д.
Для хранения таких данных используется или могут использоваться так называемые конфигурационные файлы. Одним из первых и
наиболее простых форматах конфигурационных файлов являются ini файлы. ini (Initialization File) это текстовый файл
специального формата предназначенный для хранения параметров конфигурации программы. К основным характеристикам ini
файлов относятся:

1. Текстовый формат;
2. Легко читаемый человеком;
3. наличие простой структуры;
4. Поддерживается с ранных версий ОС Windows;
5. Не требующий сложного парсинга.

ini файлы реализуются форматом *.ini. Наиболее часто используемые файлы этого формата config.ini, settings.ini, app.ini.
ini файлы впервые появились в ОС Windows 3.x Windows 95 и использовались с названиями win.ini и system.ini. Позднее их
роль частично заменил реестр Windows, однако они используются до сих пор и активно применяются: в небольших приложениях,
переносимых программах, в кроссплатформенных проектах, в научных и учебных разработках. ini файлы имеют определенную
структуру которая состоит из:

1. Секций обычно задаются в квадратных скобках и каждая секция объединяет логически связанные параметры;
2. Ключей значение которых являются различные ключевые слова;
3. Значения символом равно ключу присваиваются в соответствии с их типом;
4. Комментариев задающихся в виде строки описания которая начинается символом точка-запятая.

Например

```text
;Настройка окна
[Window]
Width=800
Height=600
Color=clSilver
Caption=MY_PROGRAM
Version=1.0
```

ini формат не поддерживает строгую типизацию, все данные хранятся как строки. Однако они программно могут
интерпретироваться как целые числа, вещественные числа, логические значения или строки. Для работы с ini файлами в
языках программирований Delphi или C++ Builder существует определенная библиотека реализованная в виде класса под
названием TIniFile. Для подключения данного модуля:

- Delphi: uses IniFile;
- C++ Builder: #include <System.IniFiles.hpp>.

Далее следует вызывать конструктор класса для созданий экземпляра объекта с привязкой с определенной переменной.

Delphi: var my_ini: TIniFile;
my_ini := TIniFile.Create('config.ini');

C++ Builder: TIniFile *my_ini = new TIniFile("config.ini");

Примечание: Далее всё для C++ Builder.

Существуют определенные методы для работы с ini файлами:

1. ReadSection для чтения имен всех корректно описанных имен раздела;
2. ReadSectionValues предназначен для прочтения имен и значений всех корректно описанных данного раздела;
3. EraseSection предназначен для удаления заданного раздела со всем содержимым;
4. ReadBool предназначен для прочтения значения типа bool с заданным именем и указанным разделом и в случаи отсутствия
   используется значение заданное по умолчанию;
5. ReadInteger для чтения переменной типа long для параметра с заданным именем и указанным разделом и в случаи
   отсутствия используется значение заданное по умолчанию;
6. ReadString для чтения переменной типа String для параметра с заданным именем и указанным разделом и в случаи
   отсутствия используется значение заданное по умолчанию;
7. WriteBool предназначен для присвоения значения заданного параметра в заданном разделе;
8. WriteInteger и WriteString в аналогии с WriteBool;
9. Values предоставляет доступ к существующему параметру с заданным именем.

```text
ini->ReadType("Section", "Name", Default);
ini->WriteType("Section", "Name", Value);
```

```text
Пример
my_ini->ReadInteger("Window", "Height", 600);
my_ini->WriteInteger("Window", "Height", 1080);
```

Для вещественных чисел сначала получаем их в виде String после конвертируем в float/double.

В библиотеке Windows API существуют специальные функции которые предназначены для работы с ini файлами.

1. GetPrivateProfileString предназначен для чтения строки;
2. WritePrivateProfileString предназначен для записи строки;
3. GetPrivateProfileInt предназначен для чтения целых чисел;
4. WritePrivateProfileInt предназначен для чтения целых чисел.

```text
GetPrivateProfileString(L"Section", L"Name", L"Default", buffer, buffer_size, L"file.ini");
WritePrivateProfileString(L"Section", L"Name", L"Value", L"file.ini");
```

```text
Пример
GetPrivateProfileString(L"Window", L"Width, L"800", buffer, 256, L"config.ini");
WritePrivateProfileString(L"Window", L"Width, L"800", buffer, 256, L"config.ini");

GetPrivateProfileInt(L"Window", L"Height", 600, L"config.ini");
```

ini файлы имеют ряд определенных преимуществ и недостатков.

Преимущество:

- простота структуры;
- легкость редактирования;
- читаемость;
- минимальные требования к парсингу;
- удобства для небольших проектов.

Недостатки:

- отсутствие строгой типизации;
- нет вложенных структур;
- нет массивов;
- ограничение возможности расширения;
- возможны проблемы при больших объемах данных.

Рассмотрим отличие ini файлов по отношению с другими форматами которые могут использоваться аналогичным образом.

